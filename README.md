# PrecRTR

<!--- Created on 2023.06.25.
Last change on 2023.09.14. -->

This is a collection of MATLAB files associated with the paper
[Implicit low-rank Riemannian schemes for the time integration of stiff partial differential equations](https://doi.org/10.1007/s10915-024-02629-8).

We propose two implicit numerical schemes for the low-rank time integration of stiff nonlinear partial differential equations. Our approach uses the preconditioned Riemannian trust-region (RTR) method of [Absil, Baker, and Gallivan, 2007](https://link.springer.com/article/10.1007/s10208-005-0179-9). We demonstrate the efficiency of our method for solving the Allen-Cahn and the Fisher-KPP equations on the manifold of fixed-rank matrices. Furthermore, our approach allows us to avoid the restriction on the time step typical of methods that use the fixed-point iteration to solve the inner nonlinear equations. Finally, we demonstrate the efficiency of the preconditioner on the same variational problems presented in [Sutti and Vandereycken, 2021](https://epubs.siam.org/doi/10.1137/20M1337430).

The RTR method is executed using solvers from the [Manopt package](https://www.manopt.org/) (version 7.0) with the Riemannian embedded submanifold geometry from [Vandereycken, 2013](https://epubs.siam.org/doi/10.1137/110845768).

The paper's calculations outlined in Appendix C ("Derivation of the Preconditioner") are implemented in the script `getPrecon`.

In the Manopt code, we inject our preconditioner in the `trustregions`, line 14-15, we have the trust-regions `tCG` solver, line 76 in the `tCG` solver, "P is the preconditioner" `v = precon(x,u)`.


If there are any problems or bugs, feel free to [contact me](mailto:msutti@ncts.tw).

If you use PrecRTR for your research, please kindly cite the following paper:

> Sutti, M., Vandereycken, B., [Implicit low-rank Riemannian schemes for the time integration of stiff partial differential equations](https://doi.org/10.1007/s10915-024-02629-8). *J Sci Comput* **101**, 3 (2024). https://doi.org/10.1007/s10915-024-02629-8.

## I) Version History

- Ver 1, 12 Sep 2023: initial release.


## II) Contents

The main folder `LFMS` contains the following subfolders:

- `mdatafiles`: contains the `*.mat` datafiles generated by the main scripts.
- `model`: contains all the scripts related to each of the four models considered in the paper: the Allen-Cahn equation (`ACE`), the Fisher-KPP equation (`FKPP`), the ``Lyapunov'' variational problem (`LYAP`) and the nonlinear PDE variational problem (`NPDE`).
- `plots`: the folder where the plots are saved.
- `postprocessing`: contains the drivers and the utilities for plotting and visualizing data.
- `reference_solutions`: contains the reference solutions generated by the scripts `Driver_*.m`.
- `utilities`: contains all the utility functions shared by the four models.


## III) Installation and Usage

No installation is required. Use the `Driver_*.m` files to run the calculations or generate the figures in the paper.
The results of the simulations will be saved as matfiles in the `mdatafiles:` folder. 
Use the `Driver_*.m` files in the `postprocessing` folder to plot and visualize data.
The figures will then be saved in the `plots` folder.


## IV) License

The code written in this repository is GPL licensed.


## V) Dependencies

* [Manopt](https://www.manopt.org/) (for numerical optimization on manifolds)

* [export_fig](https://github.com/altmany/export_fig) (for exporting publication-quality figures)

